<!doctype html><html><head><meta charset="utf-8"><title>Add Book</title><link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css' rel='stylesheet'>
<script src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js'></script></head><body><script>
if(!localStorage.getItem('role') && !location.pathname.endsWith('login.html')) { location.href = '/login.html'; }
function logout(){ localStorage.removeItem('role'); location.href='/login.html'; }
function roleHeader(){ return {'x-role': localStorage.getItem('role')||''}; }
</script>
<div class="container mt-4"><h4>Add Book/Movie</h4><form id="form"><div class="mb-3"><label>Type</label><select id="category" class="form-select"><option value="Book" selected>Book</option><option value="Movie">Movie</option></select></div><div class="mb-3"><label>Title</label><input id="title" class="form-control" required></div><div class="mb-3"><label>Author</label><input id="author" class="form-control" required></div><div class="mb-3"><label>Serial No</label><input id="serial" class="form-control" required></div><div class="mb-3"><label>Available</label><input type="checkbox" id="available" checked></div><div id="msg" class="text-danger"></div><button class="btn btn-primary">Add</button> <a class="btn btn-secondary" href="maintenance.html">Cancel</a></form></div>
<script>document.getElementById('form').addEventListener('submit', async function(e){ e.preventDefault(); const payload = { title: document.getElementById('title').value.trim(), author: document.getElementById('author').value.trim(), category: document.getElementById('category').value, serial_no: document.getElementById('serial').value.trim(), available: document.getElementById('available').checked }; if(!payload.title||!payload.author||!payload.serial_no){ document.getElementById('msg').innerText='All fields required'; return; } const res = await fetch('/api/books', { method:'POST', headers: Object.assign({'Content-Type':'application/json'}, roleHeader()), body: JSON.stringify(payload) }); const d = await res.json(); if(!res.ok){ document.getElementById('msg').innerText=d.message||'Error'; return; } alert('Added'); location.href='maintenance.html'; });</script>
</body></html>