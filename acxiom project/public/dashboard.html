<!doctype html><html><head><meta charset="utf-8"><title>Dashboard</title><link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css' rel='stylesheet'>
<script src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js'></script></head><body><script>
if(!localStorage.getItem('role') && !location.pathname.endsWith('login.html')) { location.href = '/login.html'; }
function logout(){ localStorage.removeItem('role'); location.href='/login.html'; }
function roleHeader(){ return {'x-role': localStorage.getItem('role')||''}; }
</script>
<div class="container mt-4"><div class="d-flex justify-content-between align-items-center"><h2>Library Dashboard</h2><div><span id="roleLabel"></span> <button class="btn btn-sm btn-secondary" onclick="logout()">Logout</button></div></div><hr/><div class="row"><div class="col-md-3"><div class="list-group"><a href="maintenance.html" class="list-group-item list-group-item-action">Maintenance</a><a href="search_issue.html" class="list-group-item list-group-item-action">Search & Issue</a><a href="return_book.html" class="list-group-item list-group-item-action">Return Book</a><a href="reports.html" class="list-group-item list-group-item-action">Reports</a></div></div><div class="col-md-9"><div class="card p-3" id="mainArea">Loading stats...</div></div></div></div>
<script>
document.getElementById('roleLabel').innerText = 'Role: ' + (localStorage.getItem('role') || 'guest');
async function loadStats(){ const headers = roleHeader(); const bk = await (await fetch('/api/books', {headers})).json(); const active = await (await fetch('/api/reports/active', {headers})).json(); document.getElementById('mainArea').innerHTML = '<p>Total books: '+bk.length+'</p><p>Active issues: '+active.length+'</p>'; }
loadStats();
</script>
</body></html>