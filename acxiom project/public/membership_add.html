<!doctype html><html><head><meta charset="utf-8"><title>Add Membership</title><link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css' rel='stylesheet'>
<script src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js'></script></head><body><script>
if(!localStorage.getItem('role') && !location.pathname.endsWith('login.html')) { location.href = '/login.html'; }
function logout(){ localStorage.removeItem('role'); location.href='/login.html'; }
function roleHeader(){ return {'x-role': localStorage.getItem('role')||''}; }
</script>
<div class="container mt-4"><h4>Add Membership</h4><form id="form"><div class="mb-3"><label>Membership No</label><input id="mno" class="form-control" required></div><div class="mb-3"><label>User ID</label><input id="uid" class="form-control" required></div><div class="mb-3"><label>Name</label><input id="name" class="form-control" required></div><div class="mb-3"><label>Duration</label><select id="duration" class="form-select"><option value="6" selected>6 months</option><option value="12">1 year</option><option value="24">2 years</option></select></div><div id="msg" class="text-danger"></div><button class="btn btn-primary">Add</button> <a class="btn btn-secondary" href="maintenance.html">Cancel</a></form></div>
<script>document.getElementById('form').addEventListener('submit', async function(e){ e.preventDefault(); const payload = { membership_no: document.getElementById('mno').value.trim(), user_id: document.getElementById('uid').value.trim(), name: document.getElementById('name').value.trim(), duration_months: document.getElementById('duration').value }; if(!payload.membership_no||!payload.user_id||!payload.name){ document.getElementById('msg').innerText='All fields mandatory'; return; } const res = await fetch('/api/memberships', { method:'POST', headers: Object.assign({'Content-Type':'application/json'}, roleHeader()), body: JSON.stringify(payload) }); const d = await res.json(); if(!res.ok){ document.getElementById('msg').innerText=d.message||'Error'; return; } alert('Added'); location.href='maintenance.html'; });</script>
</body></html>