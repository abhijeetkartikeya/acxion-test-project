<!doctype html><html><head><meta charset="utf-8"><title>User Mgmt</title><link href='https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css' rel='stylesheet'>
<script src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js'></script></head><body><script>
if(!localStorage.getItem('role') && !location.pathname.endsWith('login.html')) { location.href = '/login.html'; }
function logout(){ localStorage.removeItem('role'); location.href='/login.html'; }
function roleHeader(){ return {'x-role': localStorage.getItem('role')||''}; }
</script>
<div class="container mt-4"><h4>User Management</h4><form id="form"><div class="mb-3"><label>Type</label><select id="type" class="form-select"><option value="new" selected>New</option><option value="existing">Existing</option></select></div><div class="mb-3"><label>Name</label><input id="name" class="form-control" required></div><div class="mb-3"><label>Username</label><input id="username" class="form-control" required></div><div class="mb-3"><label>Role</label><select id="role" class="form-select"><option value="user">user</option><option value="admin">admin</option></select></div><div id="msg" class="text-danger"></div><button class="btn btn-primary">Create</button> <a class="btn btn-secondary" href="maintenance.html">Cancel</a></form></div>
<script>document.getElementById('form').addEventListener('submit', async function(e){ e.preventDefault(); const payload={ username: document.getElementById('username').value.trim(), name: document.getElementById('name').value.trim(), role: document.getElementById('role').value }; if(!payload.name){ document.getElementById('msg').innerText='Name is mandatory'; return; } const res = await fetch('/api/users', { method:'POST', headers: Object.assign({'Content-Type':'application/json'}, roleHeader()), body: JSON.stringify(payload) }); const d = await res.json(); if(!res.ok){ document.getElementById('msg').innerText=d.message||'Error'; return; } alert('User created'); location.href='maintenance.html'; });</script>
</body></html>